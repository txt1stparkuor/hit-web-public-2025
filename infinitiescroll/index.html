<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Infinite Scroll</title>
    <style>
        /* CSS tá»‘i thiá»ƒu Ä‘á»ƒ táº¡o khÃ´ng gian cuá»™n */
        body { font-family: sans-serif; margin: 0; padding: 20px; line-height: 1.6; }
        
        .item {
            background: #f0f0f0;
            margin-bottom: 10px;
            padding: 20px;
            border-radius: 5px;
            border-left: 5px solid #007bff;
        }

        /* Loading animation Ä‘Æ¡n giáº£n */
        .loader {
            text-align: center;
            padding: 20px;
            font-weight: bold;
            color: #666;
            display: none; /* Máº·c Ä‘á»‹nh áº©n */
        }
        .loader.show { display: block; }
    </style>
</head>
<body>

    <h1>ğŸ“œ Demo Cuá»™n VÃ´ Táº­n</h1>
    
    <!-- NÆ¡i chá»©a dá»¯ liá»‡u -->
    <div id="container"></div>

    <!-- Biá»ƒu tÆ°á»£ng loading (náº±m dÆ°á»›i cÃ¹ng) -->
    <div class="loader" id="loader">â³ Äang táº£i thÃªm dá»¯ liá»‡u...</div>

    <script>
        // 1. Cáº¤U HÃŒNH BAN Äáº¦U
        const container = document.getElementById('container');
        const loader = document.getElementById('loader');
        
        let itemCount = 0;      // Äáº¿m tá»•ng sá»‘ item Ä‘ang cÃ³
        let isLoading = false;  // Cá» tráº¡ng thÃ¡i: Äang táº£i hay khÃ´ng? (QUAN TRá»ŒNG)

        // 2. HÃ€M Táº O Dá»® LIá»†U GIáº¢ (Giáº£ láº­p láº¥y tá»« Server)
        // Tráº£ vá» má»™t máº£ng chá»©a 10 item má»›i
        function getMockData() {
            const newItems = [];
            for (let i = 0; i < 10; i++) {
                itemCount++;
                newItems.push(`Dá»¯ liá»‡u sá»‘ #${itemCount} - Ná»™i dung máº«u...`);
            }
            return newItems;
        }

        // 3. HÃ€M HIá»‚N THá»Š Dá»® LIá»†U LÃŠN MÃ€N HÃŒNH (DOM Manipulation)
        function renderItems() {
            // Báº­t cá» loading Ä‘á»ƒ cháº·n ngÆ°á»i dÃ¹ng cuá»™n tiáº¿p khi chÆ°a xong
            isLoading = true; 
            loader.classList.add('show');

            // Giáº£ láº­p Ä‘á»™ trá»… cá»§a máº¡ng (1 giÃ¢y)
            setTimeout(() => {
                const data = getMockData();

                // Táº¡o tháº» HTML vÃ  gáº¯n vÃ o container
                data.forEach(text => {
                    const div = document.createElement('div');
                    div.classList.add('item');
                    div.innerText = text;
                    container.appendChild(div);
                });

                // Táº¯t loading
                isLoading = false;
                loader.classList.remove('show');
            }, 1000);
        }

        // 4. LOGIC CHÃNH: Báº®T Sá»° KIá»†N CUá»˜N
        window.addEventListener('scroll', () => {
            // Náº¿u Ä‘ang táº£i rá»“i thÃ¬ khÃ´ng lÃ m gÃ¬ cáº£ (TrÃ¡nh spam lá»‡nh)
            if (isLoading) return;

            // --- CÃ”NG THá»¨C TÃNH TOÃN Vá»Š TRÃ CUá»˜N ---
            // 1. window.innerHeight: Chiá»u cao cá»­a sá»• trÃ¬nh duyá»‡t báº¡n Ä‘ang nhÃ¬n tháº¥y.
            // 2. window.scrollY: Báº¡n Ä‘Ã£ cuá»™n xuá»‘ng bao nhiÃªu pixel.
            // 3. document.body.offsetHeight: Tá»•ng chiá»u cao thá»±c táº¿ cá»§a toÃ n bá»™ trang web.
            
            // Náº¿u (Chiá»u cao nhÃ¬n tháº¥y + Pháº§n Ä‘Ã£ cuá»™n) >= (Tá»•ng chiá»u cao - 100px buffer)
            // Tá»©c lÃ  cÃ²n cÃ¡ch Ä‘Ã¡y 100px ná»¯a thÃ¬ táº£i tiáº¿p
            if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
                renderItems();
            }
        });

        // Gá»i láº§n Ä‘áº§u khi vÃ o trang Ä‘á»ƒ cÃ³ dá»¯ liá»‡u ban Ä‘áº§u
        renderItems();

    </script>
</body>
</html>